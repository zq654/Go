# **Raft核心思路**

## 首先需要清楚整个Raft的流程：

1. 首先每个节点都是从follower开始，需设计一个随机定时器，当定时器时间内没有收到心跳就转化身份为candidate并开始选举。
2. 在任何时期只要发现其他节点的任期大于自身的时候，就要修改自身任期已经修改身份为follower（若在选举，则停止选取，若为leader则停止心跳 并降为follower）。
3. 开始选举的时候需要先给自己投一票并将当前任期加一，然后向其他节点申请投票，当获取的选票大于一半则当选为新leader。
4. 被请求投票节点在请求投票时需要比较两者之间任期的大小，并且记录一个VoteFor表示这个任期内投票给了谁。
5. 当节点当选为leader后需要向其它节点发送心跳（传递自己任期）来确保自身的领导地位，若是刚刚当选还需要向其他节点同步日志。
6. 当leader接收到客户端的请求后，需要将日志同步发给其他节点，只有被大多数节点都接收了之后才能提交并应用于状态机，且leader只能提交当前任期的日志。